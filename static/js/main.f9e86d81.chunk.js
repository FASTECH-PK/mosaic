(this.webpackJsonpmosaic=this.webpackJsonpmosaic||[]).push([[0],{17:function(e,t,n){},18:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),c=n(11),a=n.n(c),o=(n(17),n(18),n(6)),s=n(5),u=n(2),l=n(4),d=n.n(l),f=n(7),h=n(8),p=n(1),v=function(e){var t=e.text,n=e.style,i=e.onClick,c=e.title,a=Object(r.useRef)(null);return Object(r.useEffect)((function(){var e=function(e){e.stopPropagation(),i(e)};return a.current.addEventListener("pointerdown",e),function(){a.current.removeEventListener("pointerdown",e)}}),[]),Object(p.jsx)("div",{ref:a,role:"button",title:c,style:Object(h.a)(Object(h.a)({},n),{},{height:32,lineHeight:"32px",minWidth:32,padding:"0 8px",textAlign:"center",pointerEvents:"auto"}),className:"button",children:t})},w=function(e,t){var n=Object(r.useRef)(new u.h);Object(r.useEffect)((function(){var r=e.current,i=function(e){e.preventDefault();var i=r.clientWidth,c=r.clientHeight;n.current.copy(t.position);var a=(c-e.deltaY)/c,o=Math.min(32,Math.max(1,t.position.z/a)),s=2*Math.tan(t.fov*Math.PI/360)*n.current.z/c,u=e.clientX-r.offsetLeft-i/2,l=-(e.clientY-r.offsetTop-c/2),d=u*s,f=l*s,h=2*Math.tan(t.fov*Math.PI/360)*o/c,p=u*h-d,v=l*h-f;t.position.x=n.current.x-p,t.position.y=n.current.y-v,t.position.z=o};if(r)return r.addEventListener("wheel",i,{passive:!1}),function(){r.removeEventListener("wheel",i)}}),[e,t])},b=function(e,t){var n=Object(r.useRef)(new u.h),i=Object(r.useRef)(new u.g),c=Object(r.useRef)([]);Object(r.useEffect)((function(){var r=e.current,a=c.current,s=function(e){e.preventDefault(),console.log("here"),a.push({id:e.pointerId,x:e.clientX,y:e.clientY,pointerDown:[e.clientX,e.clientY],primary:e.isPrimary});var i,c=Object(o.a)(a);try{for(c.s();!(i=c.n()).done;){var s=i.value;s.pointerDown=[s.x,s.y]}}catch(u){c.e(u)}finally{c.f()}n.current.copy(t.position),r.setPointerCapture(e.pointerId)},l=function(e){e.preventDefault();var c=r.clientWidth,o=r.clientHeight;if(1===a.length){var s=a[0];s.x=e.clientX,s.y=e.clientY;var l=2*Math.tan(t.fov*Math.PI/360)*n.current.z/o;i.current.x=(e.clientX-s.pointerDown[0])*l,i.current.y=(e.clientY-s.pointerDown[1])*l,t.position.x=n.current.x-i.current.x,t.position.y=n.current.y+i.current.y}else if(2===a.length){var d=a.filter((function(t){return t.id===e.pointerId}))[0];d.x=e.clientX,d.y=e.clientY;var f=a[0],h=a[1],p=[Math.min(f.pointerDown[0],h.pointerDown[0]),Math.min(f.pointerDown[1],h.pointerDown[1])],v=[Math.max(f.pointerDown[0],h.pointerDown[0]),Math.max(f.pointerDown[1],h.pointerDown[1])],w=[Math.min(f.x,h.x),Math.min(f.y,h.y)],b=[Math.max(f.x,h.x),Math.max(f.y,h.y)],j={down:[p[0]+(v[0]-p[0])/2,p[1]+(v[1]-p[1])/2],current:[w[0]+(b[0]-w[0])/2,w[1]+(b[1]-w[1])/2]},g=2*Math.tan(t.fov*Math.PI/360)*n.current.z/o,O=[(j.current[0]-j.down[0])*g,(j.current[1]-j.down[1])*g],x=new u.h;x.x=n.current.x-O[0],x.y=n.current.y+O[1];var m=Math.sqrt(Math.pow(f.pointerDown[0]-h.pointerDown[0],2)+Math.pow(f.pointerDown[1]-h.pointerDown[1],2)),y=(Math.sqrt(Math.pow(f.x-h.x,2)+Math.pow(f.y-h.y,2))-m)/m+1,R=j.current[0]-c/2,E=-(j.current[1]-o/2),I=R*g,C=E*g,M=Math.min(32,Math.max(1,n.current.z/y)),L=2*Math.tan(t.fov*Math.PI/360)*M/o,S=R*L-I,k=E*L-C;t.position.x=x.x-S,t.position.y=x.y-k,t.position.z=M}},d=function(e){e.preventDefault(),a.splice(a.findIndex((function(t){return t.id===e.pointerId})),1);var i,c=Object(o.a)(a);try{for(c.s();!(i=c.n()).done;){var s=i.value;s.pointerDown=[s.x,s.y]}}catch(u){c.e(u)}finally{c.f()}n.current.copy(t.position),r.releasePointerCapture(e.pointerId)};if(r)return r.addEventListener("pointerdown",s),r.addEventListener("pointermove",l),r.addEventListener("pointerup",d),function(){r.removeEventListener("pointerdown",s),r.removeEventListener("pointermove",l),r.removeEventListener("pointerup",d)}}),[e,t])},j=n(22),g=800,O=16,x=function(e){var t=e.camera,n=e.box,i=e.scene,c=e.setSrcInfo,a=e.srcCanvasRef,l=e.srcCanvasTextureRef,h=e.srcPlaneRef,x=e.setSrcId,m=e.srcInfo,y=e.activeRef,R=e.pasteSrc,E=Object(r.useRef)(null),I=Object(r.useRef)(null),C=Object(r.useRef)(null),M=Object(r.useState)(""),L=Object(s.a)(M,2),S=L[0],k=L[1];Object(r.useEffect)((function(){t.position.z=0;var e=a.current||document.createElement("canvas");a.current=e,e.width=64,e.height=64;var n=new u.a(e);l.current=n;var r=new u.e(6,6),c=new u.c({map:n}),o=new u.b(r,c);h.current=o,i.add(o),t.position.z=5}),[]),Object(r.useEffect)((function(){R&&z(R)}),[R]);var D=Object(r.useRef)(0),z=function(e){D.current++;var t=new Image,n=Object(j.a)();x(n),t.onload=function(){var e=D.current,r=Math.round(t.width/O),i=Math.round(t.height/O),o=r*O,s=i*O;k("".concat(o,"x").concat(s));var d=h.current;d.scale.x=t.width/g,d.scale.y=t.height/g;var f=E.current||document.createElement("canvas");E.current=f,f.width=o,f.height=s,f.getContext("2d").drawImage(t,0,0,f.width,f.height);var p=[],v=I.current||document.createElement("canvas");v.width=2*r,v.height=2*i;var w=v.getContext("2d");w.drawImage(t,0,0,v.width,v.height);var b=a.current;b.width=o,b.height=s,l.current=new u.a(b),d.material.map=l.current;var j=b.getContext("2d");j.fillStyle="#111",j.fillRect(0,0,b.width,b.height);var x=Array(r*i).fill(0).map((function(e,t){return t}));!function a(){for(var o=0;o<16;o++){var s=x.shift();if(void 0!==s){for(var u=s%r,d=Math.floor(s/r),f=w.getImageData(2*u,2*d,2,2).data,h=[],v=0;v<16;v+=4){var b=[f[v],f[v+1],f[v+2]];h.push(b)}p.push(h),j.drawImage(t,u*O,d*O,O,O,u*O,d*O,O,O),l.current.needsUpdate=!0,0===x.length&&(console.log("set src"),c({id:n,cols:r,rows:i,lookups:p}))}15===o&&D.current===e&&setTimeout((function(){a()}),0)}}()},t.src=e};Object(r.useEffect)((function(){z("/computers.jpg")}),[]),Object(r.useEffect)((function(){function e(){return t.apply(this,arguments)}function t(){return(t=Object(f.a)(d.a.mark((function e(){var t,n,r,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(o.a)(this.files),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=11;break}if(!((r=n.value).type.indexOf("image")<0)){e.next=7;break}return e.abrupt("continue",9);case 7:i=URL.createObjectURL(r),z(i);case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),t.e(e.t0);case 16:return e.prev=16,t.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,13,16,19]])})))).apply(this,arguments)}return C.current.addEventListener("change",e),function(){C.current.removeEventListener("change",e)}}),[]);var P=Object(r.useRef)(null);return w(P,t),b(P,t),Object(r.useEffect)((function(){m&&k("".concat(m.cols*O,"x").concat(m.rows*O))}),[m]),Object(p.jsxs)("div",{ref:P,className:"portion",onPointerDown:function(){return y.current=2},style:{position:"absolute",bottom:n.top,left:n.left,width:n.width,height:n.height,color:"#ddd",zIndex:1},children:[Object(p.jsx)("div",{style:{padding:"12px 8px"},children:"SRC"}),Object(p.jsx)("input",{type:"file",ref:C,accept:".jpg,.png,.jpeg",style:{display:"none"}}),Object(p.jsxs)("div",{style:{position:"absolute",left:0,right:0,bottom:0,display:"flex",justifyContent:"space-between",alignItems:"center",padding:16},children:[Object(p.jsx)("div",{className:"readout",children:S}),Object(p.jsx)(v,{text:"\u2191",title:"Upload image",onClick:function(){C.current.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}})]})]})},m=16,y=function(e){var t=e.camera,n=e.box,i=e.scene,c=e.setDstInfo,a=e.dstCanvasRef,l=e.swapInfo,h=e.dstCanvasTextureRef,O=e.dstPlaneRef,x=e.setDstId,y=e.dstInfo,R=e.activeRef,E=e.pasteSrc,I=Object(r.useRef)(null),C=Object(r.useRef)(null),M=Object(r.useRef)(null),L=Object(r.useState)(""),S=Object(s.a)(L,2),k=S[0],D=S[1];Object(r.useEffect)((function(){t.position.z=0;var e=a.current||document.createElement("canvas");a.current=e,e.width=64,e.height=64;var n=e.getContext("2d");n.fillStyle="#fff",n.fillRect(0,0,e.width,e.height);var r=new u.a(e);h.current=r;var c=new u.e(6,6),o=new u.c({map:r}),s=new u.b(c,o);O.current=s,i.add(s),t.position.z=5}),[]),Object(r.useEffect)((function(){E&&P(E)}),[E]);var z=Object(r.useRef)(0),P=function(e){z.current++;var t=new Image,n=Object(j.a)();x(n),t.onload=function(){var e=z.current,r=Math.round(t.width/m),i=Math.round(t.height/m),o=r*m,s=i*m;D("".concat(o,"x").concat(s));var l=O.current;l.scale.x=t.width/g,l.scale.y=t.height/g;var d=M.current||document.createElement("canvas");M.current=d,d.width=o,d.height=s,d.getContext("2d").drawImage(t,0,0,d.width,d.height);var f=[],p=C.current||document.createElement("canvas");p.width=2*r,p.height=2*i;var v=p.getContext("2d");v.drawImage(t,0,0,p.width,p.height);var w=a.current;w.width=o,w.height=s,h.current=new u.a(w),l.material.map=h.current;var b=w.getContext("2d");b.fillStyle="#111",b.fillRect(0,0,w.width,w.height);var j=Array(r*i).fill(0).map((function(e,t){return t}));!function a(){for(var o=0;o<16;o++){var s=j.shift();if(void 0!==s){for(var u=s%r,l=Math.floor(s/r),d=v.getImageData(2*u,2*l,2,2).data,p=[],w=0;w<16;w+=4){var g=[d[w],d[w+1],d[w+2]];p.push(g)}f.push(p),b.drawImage(t,u*m,l*m,m,m,u*m,l*m,m,m),h.current.needsUpdate=!0,0===j.length&&c({id:n,cols:r,rows:i,lookups:f})}15===o&&z.current===e&&setTimeout((function(){a()}),0)}}()},t.src=e};Object(r.useEffect)((function(){P("/computers.jpg")}),[]),Object(r.useEffect)((function(){function e(){return t.apply(this,arguments)}function t(){return(t=Object(f.a)(d.a.mark((function e(){var t,n,r,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(o.a)(this.files),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=11;break}if(!((r=n.value).type.indexOf("image")<0)){e.next=7;break}return e.abrupt("continue",9);case 7:i=URL.createObjectURL(r),P(i);case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),t.e(e.t0);case 16:return e.prev=16,t.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,13,16,19]])})))).apply(this,arguments)}return I.current.addEventListener("change",e),function(){I.current.removeEventListener("change",e)}}),[]),Object(r.useEffect)((function(){y&&D("".concat(y.cols*m,"x").concat(y.rows*m))}),[y]);var T=Object(r.useRef)(null);return w(T,t),b(T,t),Object(p.jsxs)("div",{ref:T,className:"portion",style:{position:"absolute",bottom:n.top,left:n.left,width:n.width,height:n.height,color:"#ddd",outline:"1px solid #3333",zIndex:1},onPointerDown:function(){return R.current=2},children:[Object(p.jsx)("div",{style:{padding:"12px 8px"},children:"DST"}),Object(p.jsx)("input",{type:"file",ref:I,accept:".jpg,.png,.jpeg",style:{display:"none"}}),Object(p.jsx)("div",{style:{position:"absolute",left:0,right:0,top:0,display:"flex",justifyContent:"end",alignItems:"center",padding:16}}),Object(p.jsxs)("div",{style:{position:"absolute",left:0,right:0,bottom:0,display:"flex",justifyContent:"space-between",alignItems:"center",padding:16},children:[Object(p.jsx)("div",{className:"readout",children:k}),Object(p.jsxs)("div",{style:{display:"flex",gap:16},children:[Object(p.jsx)(v,{text:"\u2195",title:"Swap src and dst",style:{transformOrigin:"center center",transform:"rotate(90deg)"},onClick:function(){l()}}),Object(p.jsx)(v,{text:"\u2191",title:"Upload image",onClick:function(){I.current.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}})]})]})]})},R=16,E=function(e){var t=e.camera,n=e.box,i=e.scene,c=e.srcInfo,a=e.dstInfo,o=e.srcCanvasRef,l=e.dstId,h=e.srcId,j=e.activeRef,O=Object(r.useRef)(null),x=Object(r.useRef)(null),m=Object(r.useRef)(null),y=Object(r.useState)(""),E=Object(s.a)(y,2),I=E[0],C=E[1];Object(r.useEffect)((function(){t.position.z=0;var e=O.current||document.createElement("canvas");O.current=e,e.width=64,e.height=64;var n=new u.a(e);x.current=n;var r=new u.e(6,6),c=new u.c({map:n}),a=new u.b(r,c);m.current=a,i.add(a),t.position.z=5}),[]);var M=Object(r.useRef)(0);Object(r.useEffect)((function(){if(console.log("fire"),console.log(c,a),c&&a){M.current++,console.log("regen");var e=a.cols*R,t=a.rows*R;C("".concat(e,"x").concat(t));var n=m.current;n.scale.x=e/g,n.scale.y=t/g;var r=O.current;r.width=e,r.height=t;var i=r.getContext("2d");i.fillStyle="#111",i.fillRect(0,0,e,t),m.current.material.map=new u.a(r),m.current.material.needsUpdate=!0;var s=Array(a.cols*a.rows).fill(0).map((function(e,t){return t})),d=M.current;!function e(){if(M.current===d&&h===c.id&&l===a.id)for(var t=0;t<8;t++){var n=s.shift();if(void 0!==n){for(var r=n%a.cols,u=Math.floor(n/a.cols),f=1/0,p=-1,v=a.lookups[n],w=0;w<c.cols*c.rows;w++){for(var b=c.lookups[w],j=0,g=function(e){var t=b[e],n=v[e].map((function(e,n){return Math.abs(e-t[n])})).reduce((function(e,t){return e+t}),0);j+=n},O=0;O<4;O++)g(O);j<f&&(f=j,p=w)}var x=p%c.cols,y=Math.floor(p/c.cols);i.drawImage(o.current,x*R,y*R,R,R,r*R,u*R,R,R),m.current.material.map.needsUpdate=!0,0===s.length&&console.log("done")}7===t&&setTimeout((function(){e()}),0)}}()}}),[c,a,h,l]);var L=Object(r.useRef)(null);return w(L,t),b(L,t),Object(p.jsx)("div",{ref:L,className:"portion",onPointerDown:function(){return j.current=2},style:{position:"absolute",bottom:n.top,left:n.left,width:n.width,height:n.height,color:"#ddd"},children:Object(p.jsxs)("div",{style:{position:"absolute",left:0,right:0,bottom:0,display:"flex",justifyContent:"space-between",alignItems:"center",padding:16},children:[Object(p.jsx)("div",{className:"readout",children:I}),Object(p.jsx)(v,{text:"\u2193",title:"Download image",onClick:function(){O.current.toBlob(function(){var e=Object(f.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=URL.createObjectURL(t),(r=document.createElement("a")).setAttribute("download","mosaic-"+Math.round((new Date).getTime()/1e3)+".png"),r.setAttribute("href",n),r.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}})]})})};var I=function(){var e=Object(r.useState)(!1),t=Object(s.a)(e,2),n=t[0],i=t[1],c=Object(r.useRef)(null),a=Object(r.useRef)([]),l=Object(r.useState)([]),d=Object(s.a)(l,2),f=d[0],h=d[1],w=Object(r.useState)(null),b=Object(s.a)(w,2),j=b[0],g=b[1],O=Object(r.useState)(null),m=Object(s.a)(O,2),R=m[0],I=m[1],C=Object(r.useState)(null),M=Object(s.a)(C,2),L=M[0],S=M[1],k=Object(r.useState)(null),D=Object(s.a)(k,2),z=D[0],P=D[1],T=Object(r.useState)(!1),U=Object(s.a)(T,2),H=U[0],A=U[1],N=Object(r.useRef)(null),F=Object(r.useRef)(null),X=Object(r.useRef)([]),Y=Object(r.useRef)([]),W=Object(r.useRef)(null),B=Object(r.useRef)(null),J=Object(r.useRef)(null),q=Object(r.useRef)(null),V=Object(r.useRef)(null),K=Object(r.useRef)(null),_=Object(r.useRef)(0),G=Object(r.useState)(null),Q=Object(s.a)(G,2),Z=Q[0],$=Q[1],ee=Object(r.useState)(null),te=Object(s.a)(ee,2),ne=te[0],re=te[1],ie=Object(r.useRef)([]),ce=function(){var e=window.innerWidth,t=window.innerHeight;a.current=e>t?[{left:0,top:t/2,width:e/2,height:t/2},{left:0,top:0,width:e/2,height:t/2},{left:e/2,top:0,width:e/2,height:t}]:[{left:0,top:t/2,width:e/2,height:t/2},{left:e/2,top:t/2,width:e/2,height:t/2},{left:0,top:0,width:e,height:t/2}],console.log("set layout")};ce();var ae=Object(r.useRef)(j),oe=Object(r.useRef)(R);return Object(r.useEffect)((function(){ae.current=j,oe.current=R}),[j,R]),Object(r.useEffect)((function(){var e=a.current,t=Object(s.a)(e,3),n=t[0],r=t[1],o=t[2],l=new u.d(75,n.width/n.height,.1,1e3),d=new u.d(75,r.width/r.height,.1,1e3),f=new u.d(75,o.width/o.height,.1,1e3);Y.current=[l,d,f];var h=new u.i({canvas:c.current});W.current=h,h.setSize(window.innerWidth,window.innerHeight);var p=new u.f,v=new u.f,w=new u.f;X.current=[p,v,w];var b=new u.e(1,1),j=new u.c({color:65280}),g=new u.b(b,j);v.add(g);var O=new u.e(1,1),x=new u.c({color:255}),m=new u.b(O,x);w.add(m),l.position.z=5,d.position.z=5,f.position.z=5,h.autoClear=!1,i(!0)}),[]),Object(r.useEffect)((function(){!function e(){var t=W.current;t.clear();var n=a.current,r=Object(s.a)(n,3),i=r[0],c=r[1],o=r[2],u=Y.current,l=Object(s.a)(u,3),d=l[0],f=l[1],h=l[2],p=X.current,v=Object(s.a)(p,3),w=v[0],b=v[1],j=v[2],g=i.left,O=i.top,x=i.width,m=i.height;t.setScissor(g,O,x,m),t.setViewport(g,O,x,m),t.render(w,d);var y=c.left,R=c.top,E=c.width,I=c.height;t.setScissor(y,R,E,I),t.setViewport(y,R,E,I),t.render(b,f);var C=o.left,M=o.top,L=o.width,S=o.height;t.setScissor(C,M,L,S),t.setViewport(C,M,L,S),t.render(j,h),requestAnimationFrame(e)}()}),[]),Object(r.useEffect)((function(){var e=function(){ce();for(var e=a.current,t=0;t<e.length;t++){var n=e[t],r=Y.current[t];r.aspect=n.width/n.height,r.updateProjectionMatrix()}W.current.setSize(window.innerWidth,window.innerHeight),h(e)};return e(),window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),Object(r.useEffect)((function(){var e=function(e){if(a.current){var t,n=0,r=Object(o.a)(a.current);try{for(r.s();!(t=r.n()).done;){var i=t.value,c=e.clientX,s=window.innerHeight-e.clientY;if(c>=i.left&&c<=i.left+i.width&&s>=i.top&&s<=i.top+i.height){_.current=n;break}n++}}catch(u){r.e(u)}finally{r.f()}}};return window.addEventListener("pointermove",e),function(){return window.removeEventListener("pointermove",e)}}),[]),Object(r.useEffect)((function(){var e=function(e){e.preventDefault(),e.stopPropagation();var t,n=Object(o.a)(e.clipboardData.items);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!(r.type.indexOf("image")<0)){var i=r.getAsFile(),c=URL.createObjectURL(i);0===_.current?$(c):1===_.current?re(c):alert("Choose the SRC or DST block to paste to")}}}catch(a){n.e(a)}finally{n.f()}},t=function(e){e.preventDefault(),e.stopPropagation();var t=e.dataTransfer.files[0],n=URL.createObjectURL(t);0===_.current?$(n):1===_.current?re(n):alert("Drag to the SRC or DST block")},n=function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"};return window.addEventListener("paste",e),window.addEventListener("dragover",n),window.addEventListener("drop",t),function(){window.removeEventListener("paste",e),window.removeEventListener("dragover",n),window.removeEventListener("drop",t)}}),[]),Object(r.useEffect)((function(){var e=ie.current,t=function(e){var t=Y.current[_.current],n=2*Math.tan(t.fov*Math.PI/360)*t.position.z/window.innerHeight;t.position.x-=16*e[0]*n,t.position.y+=16*e[1]*n},n=function(e){var t=Y.current[_.current],n=(window.innerHeight-e)/window.innerHeight;t.position.z=Math.min(32,Math.max(1,t.position.z/n))},r=function(r){var i=r.key.toLowerCase();"escape"===i&&A(!1),"-"===i?n(64):"+"!==i&&"="!==i||n(-64),e.includes(i)||e.push(i),(e.includes("arrowleft")||e.includes("h"))&&t([2,0]),(e.includes("arrowright")||e.includes("l"))&&t([-2,0]),(e.includes("arrowup")||e.includes("k"))&&(r.shiftKey?n(64):t([0,2])),(e.includes("arrowdown")||e.includes("j"))&&(r.shiftKey?n(-64):t([0,-2]))},i=function(t){var n=t.key.toLowerCase(),r=e.indexOf(n);-1!==r&&e.splice(r,1)};return window.addEventListener("keydown",r),window.addEventListener("keyup",i),function(){window.removeEventListener("keydown",r),window.removeEventListener("keyup",i)}}),[]),Object(p.jsxs)(p.Fragment,{children:[n?Object(p.jsxs)(p.Fragment,{children:[f[0]?Object(p.jsx)(x,{scene:X.current[0],camera:Y.current[0],box:f[0],setSrcInfo:g,srcCanvasRef:N,srcCanvasTextureRef:B,srcPlaneRef:q,setSrcId:S,srcInfo:j,activeRef:_,pasteSrc:Z}):null,f[1]?Object(p.jsx)(y,{scene:X.current[1],camera:Y.current[1],box:f[1],setDstInfo:I,dstCanvasRef:F,swapInfo:function(){var e=N.current,t=F.current;K.current=K.current||document.createElement("canvas");var n=K.current;n.width=e.width,n.height=e.height,n.getContext("2d").drawImage(e,0,0);var r=JSON.parse(JSON.stringify(ae.current));e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),B.current=new u.a(e),q.current.material.map=B.current;var i=q.current;i.scale.x=e.width/e.height,i.scale.y=1,S(oe.current.id),g(oe.current),t.width=n.width,t.height=n.height,t.getContext("2d").drawImage(n,0,0),J.current=new u.a(t),V.current.material.map=J.current;var c=V.current;c.scale.x=t.width/t.height,c.scale.y=1,P(r.id),I(r)},dstCanvasTextureRef:J,dstPlaneRef:V,setDstId:P,dstInfo:R,activeRef:_,pasteSrc:ne}):null,f[1]?Object(p.jsx)(E,{scene:X.current[2],camera:Y.current[2],box:f[2],srcId:L,dstId:z,srcInfo:j,dstInfo:R,srcCanvasRef:N,activeRef:_}):null]}):null,Object(p.jsx)("canvas",{ref:c}),Object(p.jsx)("div",{style:{position:"absolute",top:0,right:0,left:0,padding:16,display:"flex",justifyContent:"end",pointerEvents:"none",zIndex:2},children:Object(p.jsx)(v,{text:"About",onClick:function(){return A(!H)}})}),Object(p.jsx)("div",{style:{display:H?"flex":"none",position:"fixed",left:0,top:0,width:"100%",height:"100%",justifyContent:"center",alignItems:"center",zIndex:3},onClick:function(){return A(!1)},children:Object(p.jsxs)("div",{style:{background:"#222",maxWidth:440,width:"100%",fontSize:"16px",lineHeight:"24px",color:"#ddd"},onClick:function(e){return e.stopPropagation()},children:[Object(p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"16px 16px",borderBottom:"1px solid #444",position:"relative"},children:[Object(p.jsx)("div",{children:"About"}),Object(p.jsx)("div",{role:"button",style:{padding:16,position:"absolute",right:0,top:0,cursor:"pointer"},onClick:function(){return A(!1)},children:"X"})]}),Object(p.jsxs)("div",{style:{padding:16},children:[Object(p.jsx)("div",{style:{marginBottom:16},children:"Recreate one image using the tiles from another image."}),Object(p.jsxs)("div",{children:["from"," ",Object(p.jsx)("a",{href:"https://constraint.systems/",target:"_blank",children:"Constraint Systems"})]})]})]})})]})},C=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,23)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,c=t.getLCP,a=t.getTTFB;n(e),r(e),i(e),c(e),a(e)}))};a.a.render(Object(p.jsx)(i.a.StrictMode,{children:Object(p.jsx)(I,{})}),document.getElementById("root")),C()}},[[21,1,2]]]);
//# sourceMappingURL=main.f9e86d81.chunk.js.map